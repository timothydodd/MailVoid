@page "{id:long}"
@model DetailsModel
@{
    ViewData["Title"] = "Email Details";
}

<div class="container d-flex flex-column flex-grow-1">
    <h2>Email Details</h2>
    <div class="card d-flex flex-column flex-grow-1">
        <div class="card-header">
            <strong>From:</strong> @Model.Email.From <br />
            <strong>To:</strong> @Model.Email.To <br />
            <strong>Subject:</strong> @Model.Email.Subject <br />
            <strong>Sent On:</strong> @Model.Email.CreatedOn
        </div>
        <div class="card-body d-flex flex-column flex-grow-1">
            @if (Model.Email.IsHtml)
            {
                <iframe id="emailContent" style="width:100%; height:100%; border:none;"></iframe>
            }
            else
            {
                <div class="email-content" style="white-space: pre-wrap;">@Model.Email.Text</div>
            }
        </div>
    </div>
</div>

@section Scripts {
        @if (Model.Email.IsHtml)
            {
            <script>
                const emailHtmlContent = `@Html.Raw(Model.Email.Text)`;
                const iframe = document.getElementById('emailContent');
                iframe.contentWindow.document.open();
                iframe.contentWindow.document.write(emailHtmlContent);
                iframe.contentWindow.document.close();
            </script>
            }
}
